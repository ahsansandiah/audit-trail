# ==================== Audit Trail Configuration ====================
# Copy this file to .env and update with your actual values

# GCP Project ID
AUDIT_GCP_PROJECT=your-gcp-project-id

# GCP Pub/Sub Topic (untuk Producer - mengirim audit log)
AUDIT_PUBSUB_TOPIC=audit-trail

# GCP Pub/Sub Subscription (untuk Consumer - menerima dan simpan ke DB)
AUDIT_PUBSUB_SUBSCRIPTION=audit-trail-sub

# Database Driver (pgx untuk PostgreSQL, mysql untuk MySQL, sqlite3 untuk SQLite)
AUDIT_DB_DRIVER=pgx

# Database Connection String
# PostgreSQL format: postgres://username:password@host:port/database?sslmode=disable
# MySQL format: username:password@tcp(host:port)/database
AUDIT_DB_DSN=postgres://audit_user:your_password@localhost:5432/audit_db?sslmode=disable

# Database Table Name (optional, default: audit_trail)
AUDIT_TABLE=audit_trail

# ==================== GCP Authentication ====================
#
# EMULATOR (local development tanpa GCP):
#   Set PUBSUB_EMULATOR_HOST dan JANGAN set GOOGLE_APPLICATION_CREDENTIALS
#   PUBSUB_EMULATOR_HOST=localhost:8085
#
# LOCAL DEVELOPMENT (dengan GCP):
#   Option A: Service Account Key File
#   GOOGLE_APPLICATION_CREDENTIALS=/path/to/your/service-account-key.json
#
#   Option B: gcloud CLI (recommended for local)
#   $ gcloud auth application-default login
#   (No env var needed after login)
#
# PRODUCTION (GCP):
#   JANGAN set GOOGLE_APPLICATION_CREDENTIALS!
#   GCP akan otomatis menggunakan attached service account.
#
#   Cloud Run:
#   $ gcloud run deploy SERVICE_NAME --service-account SA@PROJECT.iam.gserviceaccount.com
#
#   GKE (Workload Identity):
#   Annotate ServiceAccount: iam.gke.io/gcp-service-account=SA@PROJECT.iam.gserviceaccount.com
#
#   Compute Engine:
#   Attach service account saat create VM instance
#
#   IAM Roles yang dibutuhkan:
#   - roles/pubsub.publisher
#   - roles/pubsub.subscriber
#   - roles/secretmanager.secretAccessor (jika pakai Secret Manager)

# ==================== Optional: GCP Secret Manager ====================
# ⚠️  GCP Secret Manager adalah OPTIONAL!
# Anda TIDAK PERLU Secret Manager untuk menggunakan audit-trail.
# Cukup set environment variables di atas sudah bisa jalan!
#
# Secret Manager hanya untuk:
# - Production dengan banyak microservices
# - Centralized secret management
# - Secret rotation otomatis
#
# Untuk enable (uncomment code Option B di ex_service.go):
# 1. Create secrets di GCP Secret Manager dengan names:
#    - audit-gcp-project
#    - audit-pubsub-topic
#    - audit-pubsub-subscription
#    - audit-db-driver
#    - audit-db-dsn
#    - audit-table
# 2. Uncomment code di ex_service.go (Option B)
#
# Priority: Environment Variable (checked first) → Secret Manager (fallback) → Default Value
